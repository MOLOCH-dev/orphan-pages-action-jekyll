<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="description" content="An Open Source Project for secure and robust containerized application management for constrained devices.">
	<meta property="og:title" content="Open Horizon" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://localhost:4000///docs/hub/gather_files.html" />
<meta property="og:image" content="http://localhost:4000//img/hero-dark.jpg">

	

	<meta name="citation_title" content="Project Pages - An Integrated Scientific Blogging Template">



	

	<link rel='shortcut icon' type='image/png' href='/img/favicon.png' />

    <title>Open Horizon</title>

    <link rel="canonical" href="http://localhost:4000/docs/hub/gather_files.html">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="http://localhost:4000/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="http://localhost:4000/css/clean-blog.css">

	<!-- Adjust Colors -->
    <link rel="stylesheet" href="http://localhost:4000/css/colorscheme.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="http://localhost:4000/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="/css/normalize.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/cayman.css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	<!-- Math Jax -->
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
	</script>
	<script type="text/javascript"
	src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
		TeX: { equationNumbers: { autoNumber: "AMS" } }
	});
	</script>

	<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js" type="text/javascript"></script>-->

    <!-- jQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Custom Theme JavaScript -->
	<script src="http://localhost:4000/js/clean-blog.min.js "></script>

    <!-- Clipboard.js -->
    <script src="http://localhost:4000/js/clipboard.min.js " ></script>

    <!-- CDN Hosted Clipboard.js -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script> -->


	

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Open Horizon</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>

                <li>
                    <a href="/quick-start">Quick Start</a>
                </li>

                <li>
                    <a href="/docs/">Docs</a>
                </li>

                <!-- <li>
                    <a href="/blog">Blog</a>
                </li> -->

                <li>
                    <a href="/docs/getting_started/faq.html">FAQ</a>
                </li>


            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Page Header -->
<header class="intro-header" style="background-image: url('/img/hero-dark.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="site-heading" style="padding: 75px 0">
					
                    
                    

                    <h1 style="font-size:4.0em">Open Horizon</h1>
                    <hr class="small">

                    <span class="subheading">An Open Source Project for secure and robust containerized application management for constrained devices.</span>
                    

                </div>
            </div>
        </div>
    </div>
</header>

<div class="container">
	<div class="row">
      <div class="col-lg-12 col-md-12">
			
<h1 id="prereq_horizon">Gather edge node files</h1>

<p>Several files are needed to install the Open Horizon (Open Horizon) agent on your edge devices and edge clusters and register them with Open Horizon. This content guides you through bundling the files that are needed for your edge nodes. Perform these steps on an admin host that is connected to the Open Horizon management hub.</p>

<p>The following steps assume that you have installed the <strong>cloudctl</strong> and <strong>oc</strong> CLIs, and that you are running the steps from within the unpacked installation media directory <strong>ibm-eam-4.2.0-agent-x86_64</strong>. This script searches for the required Horizon packages in the <strong>agent/edge-packages-4.2.0.tar.gz</strong> file, and creates the necessary edge node configuration and certificate files.</p>

<ol>
  <li>
    <p>Set the following environment variables. This assumes you are still logged in to <strong>oc</strong> as a result of the management hub installation steps.</p>

    <div class="language-bash codeblock highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">CLUSTER_URL</span><span class="o">=</span>https://<span class="si">$(</span>oc get cm management-ingress-ibmcloud-cluster-info <span class="nt">-o</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.data.cluster_ca_domain}'</span><span class="si">)</span>
<span class="nb">export </span><span class="nv">CLUSTER_USER</span><span class="o">=</span><span class="si">$(</span>oc <span class="nt">-n</span> ibm-common-services get secret platform-auth-idp-credentials <span class="nt">-o</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.data.admin_username}'</span> | <span class="nb">base64</span> <span class="nt">--decode</span><span class="si">)</span>
<span class="nb">export </span><span class="nv">CLUSTER_PW</span><span class="o">=</span><span class="si">$(</span>oc <span class="nt">-n</span> ibm-common-services get secret platform-auth-idp-credentials <span class="nt">-o</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.data.admin_password}'</span> | <span class="nb">base64</span> <span class="nt">--decode</span><span class="si">)</span>
oc <span class="nt">--insecure-skip-tls-verify</span><span class="o">=</span><span class="nb">true</span> <span class="nt">-n</span> kube-public get secret ibmcloud-cluster-ca-cert <span class="nt">-o</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s2">"{.data.ca</span><span class="se">\.</span><span class="s2">crt}"</span> | <span class="nb">base64</span> <span class="nt">--decode</span> <span class="o">&gt;</span> ieam.crt
<span class="nb">export </span><span class="nv">HZN_MGMT_HUB_CERT_PATH</span><span class="o">=</span><span class="s2">"</span><span class="nv">$PWD</span><span class="s2">/ieam.crt"</span>
<span class="nb">export </span><span class="nv">HZN_FSS_CSSURL</span><span class="o">=</span><span class="k">${</span><span class="nv">CLUSTER_URL</span><span class="k">}</span>/edge-css
</code></pre></div>    </div>
  </li>
  <li>
    <p>Move into the <strong>agent</strong> directory where <strong>edge-packages-4.2.0.tar.gz</strong> is:</p>

    <div class="language-bash codeblock highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>agent
</code></pre></div>    </div>
  </li>
  <li>
    <p>Run the <strong>edgeNodeFiles.sh</strong> script to gather the necessary files and put them in the CSS (Cloud Sync Service) component of the Model Management System. (The <strong>edgeNodeFiles.sh</strong> script was installed as part of the <strong>horizon-cli</strong> package and should be in your path.)</p>

    <div class="language-bash codeblock highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">HZN_EXCHANGE_USER_AUTH</span><span class="o">=</span><span class="s1">''</span> edgeNodeFiles.sh ALL <span class="nt">-c</span> <span class="nt">-p</span> edge-packages-4.2.0
</code></pre></div>    </div>

    <p>On each edge node use the <strong>-i ‘css:’</strong> flag of <strong>agent-install.sh</strong> to have it get the needed files from CSS.</p>

    <p><strong>Note:</strong> If you plan to use <a href="/docs/installing/sdo.html">SDO-enabled edge devices</a>, you must run this form of the <code class="language-plaintext highlighter-rouge">edgeNodeFiles.sh</code> command.</p>
  </li>
  <li>
    <p>Alternatively, use <strong>edgeNodeFiles.sh</strong> to bundle the files in a tar file:</p>

    <div class="language-bash codeblock highlighter-rouge"><div class="highlight"><pre class="highlight"><code>edgeNodeFiles.sh ALL <span class="nt">-t</span> <span class="nt">-p</span> edge-packages-4.2.0
</code></pre></div>    </div>

    <p>Copy the tar file to each edge node and use the <strong>-z</strong> flag of <strong>agent-install.sh</strong> to get the needed files from tar file.</p>
  </li>
</ol>

<p><strong>Note:</strong> <strong>edgeNodeFiles.sh</strong> has more flags to control what files are gathered and where they should be placed. To see all of the available flags, run: <strong>edgeNodeFiles.sh -h</strong></p>

<h2 id="whats-next">What’s next</h2>

<p>Before edge nodes are set up, you or your node technicians must create an API key and gather other environment variable values. Follow the steps in <a href="/docs/hub/prepare_for_edge_nodes.html">Prepare for setting up edge nodes</a>.</p>

      </div>
	</div>
</div>

<hr>


	
    <!-- Footer -->
<footer>

    <div class="container">
        <div class="row">
             <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"> 
                 <ul class="list-inline text-center">
                    <!-- <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li> -->
                    
                    
                    
                    <li>
                        <a href="https://github.com/open-horizon">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
					
                    <li>
                        <a href="https://github.com/open-horizon/open-horizon.github.io/issues">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-exclamation fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		         <li>
                        <a href="https://wiki.lfedge.org/display/OH/Open+Horizon">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-info fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <!-- <li>
                        <a href="https://github.com/projectpages/project-pages/fork">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-code-fork fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li> -->
                    
                </ul> 

                <div align="center">
                  <div class="copytext"><p><a href="https://app.slack.com/client/THT8G7R0V/C011XLC1V2Q" target="_blank" style="text-decoration:none">Join Chat</a>   |   <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank" style="text-decoration:none">License</a>   |   ©2020 IBM. All rights reserved</p></div>

                </div>

        </div>
    </div>
</footer>


</body>

</html>
